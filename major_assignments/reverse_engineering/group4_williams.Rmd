---
title: "Reverse Engineering Project"
author: "Shifra Dayak, Benjamin Ferraro, Tim Williams"
date: "3/4/24"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are reverse engineering the story, [Her Baby Died After Hurricane Katrina. Was It a Crime?](https://www.themarshallproject.org/2021/12/16/her-baby-died-after-hurricane-katrina)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
# Turn off scientific notation
options(scipen=999)
library(tidyverse)
library(lubridate)
library(janitor)

```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 

```{r}
# Load required data
louisiana_parole <- read_csv("data/parole-cleaned-open-refine.csv") |>
#age_bucket column data cleaned in OpenRefine; see Sentence 5.

# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 
clean_names()
#We already cleaned the names but included for demonstration.

```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: Nearly 4,200 men and women are serving lifetime sentences in the state, for crimes that range from homicide and rape to rarer cases of repeat purse snatchings and child neglect, an investigation by The Marshall Project and The Times-Picayune | The Advocate found.
* **Analysis summary**: This is a pretty straightforward count of the  Department of Corrections ID numbers for charges for those serving life sentences. The distinct function is needed because some prisoners have multiple charges. The exact number appears to be 4,177 people.

```{r}
# Put code to reverse engineer sentence here
deduped_louisiana_parole <- louisiana_parole |>
distinct(doc_number) |>
  summarise(
    distinct_people = n()
  )

# Display results of code below this codeblock

deduped_louisiana_parole

```

### Sentence 2

* **Sentence text**: More than half of the people serving life in Louisiana were convicted of second-degree murder, our investigation found ...
* **Analysis summary**: Filtering by the second-degree murder offense and then grouping and counting the doc numbers, we find that 2,242 of those serving life sentences have at least one second-degree murder conviction, which is about 54 percent of the 4,177 total.

```{r}
# Put code to reverse engineer sentence here
life_charges <- louisiana_parole |>
  filter(offenses == "SECOND DEGREE MURDER") |>
  group_by(doc_number) |>
  summarise (
    count = n()
  ) |>
  summarise(n())

# Display results of code below this codeblock
life_charges
```

### Sentence 3

* **Sentence text**: ... including over three-quarters of the 124 women serving life (parole is forbidden for almost all life sentences in the state).
* **Analysis summary**: Using the filter and group by functions, we first counted the number of women serving life sentences according for second degree murder, and then divided that by the total number of women serving life sentences, which we obtained using the same functions. 77 percent, which is over three-quarters, fit that criteria.

```{r}
# Put code to reverse engineer sentence here

louisiana_parole |>
  filter(gender == "F" & offenses == "SECOND DEGREE MURDER") |>
  group_by(doc_number) |>
  summarise (
   count = n()
  ) |>
  summarise(n()) /
  
louisiana_parole |>
  filter(gender == "F") |>
  group_by (doc_number)|>
  summarise (
    count = n()
  ) |>
  summarise (n()) 


# Display results of code below this codeblock
```

### Sentence 4

* **Sentence text**: More than 70% of people serving life without parole are Black, according to our analysis of state data.
* **Analysis summary**: A similar process of filtering by race, grouping by doc number to get rid of duplicates, and counting. We did this to obtain the number of Black inmates and then divided that by the total number of inmates serving life, which is about 73 percent.

```{r}
# Put code to reverse engineer sentence here
louisiana_parole |>
  filter(race=="B") |>
  group_by(doc_number) |>
  summarise (
    count = n()
  ) |>
  summarise(n())/

louisiana_parole |>
  group_by(doc_number) |>
  summarise (
    count = n()
  ) |>
  summarise(n())

# Display results of code below this codeblock

```

### Sentence 5

* **Sentence text**: [Statement in the data notebook appendix]: More than half of the people serving life without parole are between the ages of 40 and 60.
* **Analysis summary**: The data values were listed in categories like "40 - 50." Writing code around the hyphens seemed like a pain, so we used OpenRefine to clean them. Then we grouped by doc number to get rid of duplicate inmates, counted the number of inmates in the 40 to 50 category and 50 to 60 category, and added those categories to get 2,273 inmates. Then we divided that by another block of code returning the total number of inmates, to find that those age categories make up about 54 percent of the total inmates in the data set.

```{r}
# Put code to reverse engineer sentence here
(louisiana_parole |>
  filter(bucket_age =="40 to 50") |>
  group_by(doc_number) |>
  summarise(
    count=n()
    ) |>
  summarise(n()) +

louisiana_parole |>
  filter(bucket_age=="50 to 60") |>
  group_by(doc_number) |>
  summarise(
    count=n()
    ) |>
  summarise(n()) ) /
  
louisiana_parole |>
  group_by(doc_number) |>
  summarise (
    count= n()
  ) |>
  summarise(n())

# Display results of code below this codeblock

```

-30-